(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{431:function(t,a,s){"use strict";s.r(a);var e=s(2),v=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"_1-项目整体介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-项目整体介绍"}},[t._v("#")]),t._v(" 1.项目整体介绍")]),t._v(" "),a("p",[t._v("之前一直关注的博主阿斌，写了个mallchat聊天加购物的网站，看了下用的技术之前 都没怎么用过，挺想学一学，所以进了阿斌的知识星球，想了解下这个项目，打算从零到一复制一下mallchat项目，才能更加了解其中细节。过程中也可以发现项目任何可优化的点，联系阿斌，阿斌确认后可帮助优化，成为抹茶的")]),t._v(" "),a("p",[t._v("阿斌mallchat项目网址："),a("code",[t._v("https://mallchat.cn/https://test.mallchat.cn/")])]),t._v(" "),a("p",[t._v("后端源码: "),a("code",[t._v("https://github.com/zongzibinbin/MallChat")])]),t._v(" "),a("p",[t._v("前段源码: "),a("code",[t._v("https://github.com/Evansy/MallChatWeb")])]),t._v(" "),a("p",[t._v("IM参考阅读文章: "),a("code",[t._v("http://www.52im.net/forum.php?mod=viewthread&tid=753")])]),t._v(" "),a("h2",{attrs:{id:"_2-项目大纲"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-项目大纲"}},[t._v("#")]),t._v(" 2.项目大纲")]),t._v(" "),a("p",[t._v("先看看这个项目目前更新的大纲，能够了解有哪些基本功能点，再去看项目，就会有迹可循，阿斌持续更新中")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://vuepress-starter.oss-cn-shenzhen.aliyuncs.com/mallchat/2023/09/02/%E9%A1%B9%E7%9B%AE%E5%A4%A7%E7%BA%B2.png"}}),t._v(" "),a("p",[t._v("连接管理：netty实现websocket，消息推动，协议约定json+type，心跳检测")]),t._v(" "),a("p",[t._v("用户模块：用户背包 --\x3e徽章，改名卡")]),t._v(" "),a("p",[t._v("认证模块--\x3e 微信扫码登录，token认证，token续期， 黑名单")]),t._v(" "),a("p",[t._v("消息模块：消息列表，游标翻页；消息回复，定位跳转；消息时间展示；接受消息推送；频控；消息标记 ，点赞，点踩；url高亮；消息撤回")]),t._v(" "),a("p",[t._v("群成员模块：在线人数，总人数，成员列表双Zset游标翻页，上下限推送")]),t._v(" "),a("p",[t._v("会员列表：目前只有千人群李这一个会话，单聊已在开发中...")]),t._v(" "),a("p",[t._v("基础功能：拦截器+切面+过滤器 --\x3e链路追踪Id植入上下文，用户认证，ip+uid收集进上下文，黑名单拦截，接口日志打印； ip解析异步队列；频控注解；分布式\t\t\t\t  锁注解； 游标翻页工具类RedisUtil ；通用异常处理")]),t._v(" "),a("p",[t._v("中间件：mysql,redis,nginx,rocketmq等")]),t._v(" "),a("p",[t._v("上面是项目目前已有的一些功能点我们可以从接口级别，去查看具体的某一个功能实现逻辑，也可以从包的层面，先找到基础组件，比如拦截器的包，注解包，配置类的包去看看项目的基本能力有哪些。")]),t._v(" "),a("h2",{attrs:{id:"_3-数据库设计"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-数据库设计"}},[t._v("#")]),t._v(" 3.数据库设计")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://vuepress-starter.oss-cn-shenzhen.aliyuncs.com/mallchat/2023/09/02/%E6%95%B0%E6%8D%AE%E5%BA%93.png",alt:""}})]),t._v(" "),a("p",[t._v("打开链接可看备注： https://drawsql.app/teams/-328/diagrams/-2")]),t._v(" "),a("h2",{attrs:{id:"_4-项目结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-项目结构"}},[t._v("#")]),t._v(" 4.项目结构")]),t._v(" "),a("h3",{attrs:{id:"maven模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#maven模块"}},[t._v("#")]),t._v(" maven模块：")]),t._v(" "),a("p",[t._v("在阅读之前，先了解下抹茶的包结构。抹茶采用了maven的模块化架构模式")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://vuepress-starter.oss-cn-shenzhen.aliyuncs.com/mallchat/2023/09/02/maven%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84.png"}}),t._v(" "),a("p",[t._v("父工程"),a("code",[t._v("MallChat")]),t._v("统一进行包的版本管理")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://vuepress-starter.oss-cn-shenzhen.aliyuncs.com/mallchat/2023/09/02/%E4%BE%9D%E8%B5%96.png"}}),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://vuepress-starter.oss-cn-shenzhen.aliyuncs.com/mallchat/2023/09/02/%E4%BE%9D%E8%B5%962.png"}}),t._v(" "),a("p",[t._v("子工程只需要引入包，不需要指定版本")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://vuepress-starter.oss-cn-shenzhen.aliyuncs.com/mallchat/2023/09/02/%E4%BE%9D%E8%B5%963.png"}}),t._v(" "),a("h3",{attrs:{id:"业务包结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#业务包结构"}},[t._v("#")]),t._v(" 业务包结构：")]),t._v(" "),a("p",[t._v("mallchat-chat-server 聊天室的服务模块")]),t._v(" "),a("p",[t._v("针对不同的业务模块进行了划分，后面也会方便进行微服务的拆分")]),t._v(" "),a("h3",{attrs:{id:"dao"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dao"}},[t._v("#")]),t._v(" dao")]),t._v(" "),a("p",[t._v("一个接口调用的流转一般是intecepter->controller->service->cache->dao->mapper\ndao是对mapper的又一层包装，里面提供更灵活的查询方式，同时也收口了数据库的访问，所有对数据库的操作都从dao走，如果需要写sql，就dao再调用mapper。")]),t._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:"https://vuepress-starter.oss-cn-shenzhen.aliyuncs.com/mallchat/2023/09/02/dao1.png"}}),t._v(" "),a("h3",{attrs:{id:"domain"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#domain"}},[t._v("#")]),t._v(" domain")]),t._v(" "),a("p",[t._v("domain包下放的都是一些传输对象。不同公司的定义会有差别，下面介绍抹茶的定义")]),t._v(" "),a("p",[a("code",[t._v("dto")]),t._v("：面向service的业务处理，作为基础功能接口的入参出参定义")]),t._v(" "),a("p",[a("code",[t._v("vo")]),t._v("：面向的是前端交互，包含"),a("code",[t._v("reqVO")]),t._v("和"),a("code",[t._v("respVO")]),t._v("，前端视图层对象。经常的用法是前端传来的vo，我们会在处理的过程中，转换成"),a("code",[t._v("dto")]),t._v("进行每个小功能的调用，最后将结果通过"),a("code",[t._v("适配器")]),t._v("组装回前端展示的VO。")]),t._v(" "),a("p",[a("code",[t._v("entity")]),t._v("：面向持久化存储，ORM对象的关系映射。数据库有张user表，我们就有个User对象")]),t._v(" "),a("h3",{attrs:{id:"service"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#service"}},[t._v("#")]),t._v(" service")]),t._v(" "),a("p",[t._v("这个就比较简单，基本所有的业务逻辑处理都在这个包下。")]),t._v(" "),a("h3",{attrs:{id:"adapter"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#adapter"}},[t._v("#")]),t._v(" adapter")]),t._v(" "),a("p",[t._v("我们常说的适配器模式，其实一点儿也不高端。就是给你个入参，把他的数据结构转换一下，变成下一个流程的入参，或者直接传化成本次请求的出参VO。它可以屏蔽复杂的代码逻辑，让代码可读性变的更清晰，我们只需要知道它完成转换的功能。")]),t._v(" "),a("img",{attrs:{src:"https://vuepress-starter.oss-cn-shenzhen.aliyuncs.com/mallchat/2023/09/02/adapter1.png"}}),t._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:"https://vuepress-starter.oss-cn-shenzhen.aliyuncs.com/mallchat/2023/09/02/adapter2.png"}}),t._v(" "),a("h3",{attrs:{id:"cache"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cache"}},[t._v("#")]),t._v(" cache")]),t._v(" "),a("p",[t._v("统一收口管理项目的缓存，这样无论是需要使用还是需要清除，就比较容易找到对应位置。他在"),a("code",[t._v("common")]),t._v("包模块，因为admin端经常修改完需要调用缓存清除，C端需要调用缓存查询，所以要在公共包。")]),t._v(" "),a("p",[t._v("抽出来也能避免同类调用失效的尴尬场景")]),t._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:"https://vuepress-starter.oss-cn-shenzhen.aliyuncs.com/mallchat/2023/09/02/cache.png"}})])}),[],!1,null,null,null);a.default=v.exports}}]);