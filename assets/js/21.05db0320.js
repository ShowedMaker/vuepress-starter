(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{434:function(t,a,_){"use strict";_.r(a);var e=_(2),v=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"待办功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#待办功能"}},[t._v("#")]),t._v(" 待办功能")]),t._v(" "),a("p",[t._v("pr流程 "),a("code",[t._v("https://blog.csdn.net/qq_39876147/article/details/125117512")])]),t._v(" "),a("p",[t._v("有兴趣的在该文章下评论，就可以拉取分支开始开发了。")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("url解析组件升级")])]),t._v(" "),a("li",[a("p",[t._v("lru并发map存登录码code")])]),t._v(" "),a("li",[a("p",[t._v("敏感词工具类封装多种算法")])]),t._v(" "),a("li",[a("p",[t._v("频控校验编程式")])]),t._v(" "),a("li",[a("p",[t._v("gpt的上下文能力")])]),t._v(" "),a("li",[a("p",[t._v("手动校验工具类")])]),t._v(" "),a("li",[a("p",[t._v("握手认证")])]),t._v(" "),a("li",[a("p",[t._v("敏感词过滤")])]),t._v(" "),a("li",[a("p",[t._v("敏感词优化")])])]),t._v(" "),a("h2",{attrs:{id:"_1-握手认证"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-握手认证"}},[t._v("#")]),t._v(" 1.握手认证")]),t._v(" "),a("p",[t._v("对于已登录的用户，前端拥有用户的token。在用户刷新网页的时候，前端会重新建立websocket链接，建立连接后，发送对应消息进行用户认证，传输token，对连接进行认证。")]),t._v(" "),a("p",[t._v("改版：")]),t._v(" "),a("p",[t._v("建立链接的时候就附带token信息。后端在握手阶段就会进行连接的校验。然后返回对应的信息。")]),t._v(" "),a("p",[t._v("这样的改版，可以让用户在每次刷新页面的时候，更快得到认证的响应。")]),t._v(" "),a("h3",{attrs:{id:"需要解决的难点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#需要解决的难点"}},[t._v("#")]),t._v(" 需要解决的难点")]),t._v(" "),a("h4",{attrs:{id:"_1-前端可以在建立链接的时候能携带参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-前端可以在建立链接的时候能携带参数"}},[t._v("#")]),t._v(" 1.前端可以在建立链接的时候能携带参数")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('new WebSocket("wss://api.mallchat.cn/websocket","token");\n')])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h4",{attrs:{id:"_2-后端接受参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-后端接受参数"}},[t._v("#")]),t._v(" 2.后端接受参数")]),t._v(" "),a("p",[t._v("前端携带的参数具体是在请求头还是在哪，需要debug试试。")]),t._v(" "),a("p",[t._v("具体是在协议升级前能获得，还是协议升级后才能获得，也需要试试。")]),t._v(" "),a("p",[t._v("协议升级前位置："),a("code",[t._v("com.abin.mallchat.custom.user.websocket.HttpHeadersHandler#channelRead")])]),t._v(" "),a("p",[t._v("协议升级后位置："),a("code",[t._v("com.abin.mallchat.custom.user.websocket.NettyWebSocketServerHandler")])]),t._v(" "),a("h4",{attrs:{id:"_3-后端返回成功或失败"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-后端返回成功或失败"}},[t._v("#")]),t._v(" 3.后端返回成功或失败")]),t._v(" "),a("ol",[a("li",[a("h5",{attrs:{id:"对于认证成功的-我们当作已登录用户-需要更新websocket信息。"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#对于认证成功的-我们当作已登录用户-需要更新websocket信息。"}},[t._v("#")]),t._v(" 对于认证成功的，我们当作已登录用户，需要更新websocket信息。")])]),t._v(" "),a("li",[a("h5",{attrs:{id:"对于失败的-我们也会保持连接。当作游客连接-并返回认证失败的消息。"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#对于失败的-我们也会保持连接。当作游客连接-并返回认证失败的消息。"}},[t._v("#")]),t._v(" 对于失败的，我们也会保持连接。当作游客连接，并返回认证失败的消息。")])])]),t._v(" "),a("p",[t._v("可参考之前的逻辑 "),a("code",[t._v("com.abin.mallchat.custom.user.service.WebSocketService#authorize")])]),t._v(" "),a("h3",{attrs:{id:"或者"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#或者"}},[t._v("#")]),t._v(" 或者")]),t._v(" "),a("p",[t._v("如果我们把三步分为两步，第二步返回的时候是触发前端的消息事件。")]),t._v(" "),a("p",[t._v("也许我们还能做得更好，在连接的时候，直接把信息返回。触发的可能就是前端的连接响应事件。")]),t._v(" "),a("p",[t._v("这就是真正的握手认证了，需要调研")]),t._v(" "),a("h2",{attrs:{id:"_2-url解析组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-url解析组件"}},[t._v("#")]),t._v(" 2.url解析组件")]),t._v(" "),a("p",[t._v("目前的url解析只能解析标题，没有解析出描述和图片，比较可惜。")]),t._v(" "),a("p",[t._v("我们需要增加url解析组件的能力，让他能解析出描述和图片")]),t._v(" "),a("p",[t._v("比如企业微信的解析能力：")]),t._v(" "),a("p",[t._v("目前的url解析只能解析标题，没有解析出描述和图片，比较可惜。")]),t._v(" "),a("p",[t._v("我们需要增加url解析组件的能力，让他能解析出描述和图片")]),t._v(" "),a("p",[t._v("比如企业微信的解析能力：")]),t._v(" "),a("p",[t._v("目前的url解析只能解析标题，没有解析出描述和图片，比较可惜。\n我们需要增加url解析组件的能力，让他能解析出描述和图片\n比如企业微信的解析能力：")])])}),[],!1,null,null,null);a.default=v.exports}}]);